<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>3D to SVG Converter</title>
        <style>
            * {
                box-sizing: border-box;
                margin: 0;
                padding: 0;
            }

            body {
                font-family:
                    -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
                    sans-serif;
                background: var(--figma-color-bg);
                color: var(--figma-color-text);
                height: 100vh;
                overflow: hidden;
            }

            .main-container {
                height: 100%;
                width: 100%;
                min-width: 800px;
                display: flex;
            }

            .layout-container {
                flex: 1;
                display: flex;
                flex-direction: row;
            }

            .left-column {
                flex: 1;
                display: flex;
                flex-direction: column;
                min-width: 300px;
                border-right: 1px solid var(--figma-color-bg);
            }

            .right-column {
                width: 320px;
                background: var(--figma-color-bg);
                display: flex;
                flex-direction: column;
                height: 100%;
            }

            /* File Picker Styles */
            .file-picker {
                flex: 1;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                background-color: var(--figma-color-bg-secondary);
                border-radius: 0 0 0 10px;
                margin: 8px;
                text-align: center;
                transition: all 0.3s ease;
            }

            .file-picker-icon {
                width: 48px;
                height: 48px;
                margin-bottom: 16px;
                opacity: 0.5;
            }

            .file-picker-text {
                font-size: 14px;
                font-weight: 500;
                margin-bottom: 8px;
            }

            .file-picker-hint {
                font-size: 12px;
                opacity: 0.7;
                margin-bottom: 16px;
            }

            .file-select-button {
                padding: 10px 20px;
                border: 1px solid var(--figma-color-border);
                border-radius: 6px;
                background: var(--figma-color-bg-brand);
                color: var(--figma-color-text-onbrand);
                font-size: 12px;
                font-weight: 500;
                cursor: pointer;
                transition: all 0.2s ease;
            }

            .file-select-button:hover {
                background: var(--figma-color-bg-brand-hover);
            }

            /* Viewer Container */
            .viewer-container {
                flex: 1;
                position: relative;
                border-radius: 0 0 0 10px;
                overflow: hidden;
                background: #f5f5f5;
                margin: 0;
                display: none;
            }

            .viewer-container.visible {
                display: block;
            }

            #threejs-canvas {
                width: 100%;
                height: 100%;
                display: block;
            }

            /* Drag and Drop States */
            .file-picker.drag-over {
                border-color: var(--figma-color-bg-brand);
                background-color: var(--figma-color-bg-brand-tertiary);
                transform: scale(1.02);
            }

            .file-picker.hidden {
                display: none !important;
            }

            .file-input {
                display: none;
            }

            /* Right Column Controls */
            .controls-header {
                padding: 16px;
                border-bottom: 1px solid var(--figma-color-border);
            }

            .controls-title {
                font-size: 14px;
                font-weight: 600;
                margin-bottom: 8px;
            }

            .controls-subtitle {
                font-size: 11px;
                color: var(--figma-color-text-secondary);
            }

            .controls-tabs {
                display: flex;
                border-bottom: 1px solid var(--figma-color-border);
            }

            .tab-button {
                flex: 1;
                padding: 12px 8px;
                background: none;
                border: none;
                color: var(--figma-color-text-secondary);
                font-size: 11px;
                font-weight: 500;
                cursor: pointer;
                transition: all 0.2s ease;
                border-bottom: 2px solid transparent;
            }

            .tab-button:hover {
                color: var(--figma-color-text);
                background: var(--figma-color-bg-hover);
            }

            .tab-button.active {
                color: var(--figma-color-text);
                border-bottom-color: var(--figma-color-bg-brand);
            }

            .tab-content {
                flex: 1;
                overflow-y: auto;
                padding: 16px;
                min-height: 0;
            }

            .tab-panel {
                display: none;
            }

            .tab-panel.active {
                display: block;
            }

            /* Control Groups */
            .control-group {
                margin-bottom: 20px;
            }

            .control-label {
                font-size: 12px;
                font-weight: 500;
                margin-bottom: 8px;
                display: block;
            }

            .control-input {
                width: 100%;
                padding: 8px 12px;
                border: 1px solid var(--figma-color-border);
                border-radius: 4px;
                background: var(--figma-color-bg);
                color: var(--figma-color-text);
                font-size: 12px;
            }

            .control-slider {
                width: 100%;
                height: 4px;
                border-radius: 2px;
                background: var(--figma-color-border);
                outline: none;
                -webkit-appearance: none;
            }

            .control-slider::-webkit-slider-thumb {
                appearance: none;
                width: 16px;
                height: 16px;
                border-radius: 50%;
                background: var(--figma-color-bg-brand);
                cursor: pointer;
            }

            .control-slider::-moz-range-thumb {
                width: 16px;
                height: 16px;
                border-radius: 50%;
                background: var(--figma-color-bg-brand);
                cursor: pointer;
                border: none;
            }

            .slider-value {
                font-size: 11px;
                color: var(--figma-color-text-secondary);
                text-align: right;
                margin-top: 4px;
            }

            .color-input {
                width: 100%;
                height: 32px;
                border: 1px solid var(--figma-color-border);
                border-radius: 4px;
                cursor: pointer;
            }

            /* Action Buttons */
            .action-buttons {
                padding: 16px;
                border-top: 1px solid var(--figma-color-border);
                background: var(--figma-color-bg);
                display: none;
                margin-top: auto;
            }

            .action-buttons.visible {
                display: block;
            }

            .button-group {
                display: flex;
                flex-direction: row;
                gap: 8px;
            }

            .button {
                display: inline-block;
                padding: 12px 16px;
                border: 1px solid var(--figma-color-border);
                border-radius: 6px;
                background: var(--figma-color-bg);
                color: var(--figma-color-text);
                font-size: 12px;
                font-weight: 500;
                cursor: pointer;
                transition: all 0.2s ease;
                text-align: center;
            }

            .button:hover {
                background: var(--figma-color-bg-hover);
            }

            .button.primary {
                background: var(--figma-color-bg-brand);
                color: var(--figma-color-text-onbrand);
                border-color: var(--figma-color-bg-brand);
            }

            .button.primary:hover {
                background: var(--figma-color-bg-brand-hover);
            }

            .button:disabled {
                opacity: 0.4;
                cursor: not-allowed;
            }

            /* Loading and Error States */
            .loading {
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                font-size: 12px;
                color: var(--figma-color-text-secondary);
                background: var(--figma-color-bg);
                padding: 12px 20px;
                border-radius: 6px;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
                display: none;
            }

            .loading.visible {
                display: block;
            }

            .loading::after {
                content: "";
                display: inline-block;
                width: 16px;
                height: 16px;
                margin-left: 8px;
                border: 2px solid var(--figma-color-border);
                border-radius: 50%;
                border-top-color: var(--figma-color-bg-brand);
                animation: spin 1s linear infinite;
            }

            @keyframes spin {
                to {
                    transform: rotate(360deg);
                }
            }

            .error {
                display: none;
                padding: 12px;
                margin: 8px;
                background: var(--figma-color-bg-danger);
                color: var(--figma-color-text-ondanger);
                border-radius: 6px;
                font-size: 12px;
                border: 1px solid var(--figma-color-border-danger);
            }

            .error.success {
                background: var(--figma-color-bg-success);
                color: var(--figma-color-text-onsuccess);
                border-color: var(--figma-color-border-success);
            }

            .hidden {
                display: none !important;
            }

            /* Progress Bar */
            .progress-bar-container {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                height: 4px;
                background: var(--figma-color-border);
                z-index: 1000;
                display: none;
            }

            .progress-bar-container.visible {
                display: block;
            }

            .progress-bar {
                height: 100%;
                background: var(--figma-color-bg-brand);
                width: 0%;
                transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
                box-shadow: 0 0 8px rgba(24, 160, 251, 0.5);
            }

            .progress-text {
                display: none;
                position: absolute;
                top: -30px;
                right: 8px;
                font-size: 11px;
                color: var(--figma-color-text);
                background: var(--figma-color-bg);
                padding: 4px 8px;
                border-radius: 4px;
                white-space: nowrap;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
                font-weight: 500;
            }

            .progress-text.visible {
                display: block;
            }

            @media (max-width: 700px) {
                .main-container {
                    flex-direction: column;
                }

                .right-column {
                    width: 100%;
                    height: 50%;
                    min-height: 400px;
                }

                .left-column {
                    height: 50%;
                    min-height: 300px;
                }
            }
        </style>
    </head>
    <body>
        <div class="main-container">
            <div class="layout-container">
                <!-- Left Column: File Picker / Viewer -->
                <div class="left-column">
                    <!-- File Picker -->
                    <div class="file-picker" id="filePicker">
                        <svg
                            class="file-picker-icon"
                            viewBox="0 0 24 24"
                            fill="currentColor"
                        >
                            <path
                                d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"
                            />
                        </svg>
                        <div class="file-picker-text">
                            Select your 3D model or SVG
                        </div>
                        <div class="file-picker-hint">
                            Supports .glb, .gltf, and .svg files (max 50MB)<br />
                            Drag and drop or click to browse
                        </div>

                        <button
                            class="file-select-button"
                            id="selectFileButton"
                            type="button"
                        >
                            Choose File
                        </button>
                        <input
                            type="file"
                            class="file-input"
                            id="fileInput"
                            accept=".glb,.gltf,.svg,application/octet-stream,image/svg+xml"
                            aria-label="Select 3D model or SVG file"
                        />
                    </div>

                    <!-- 3D Viewer Container -->
                    <div class="viewer-container" id="viewerContainer">
                        <canvas id="threejs-canvas"></canvas>
                        <div class="loading" id="loading">Loading model...</div>
                    </div>
                </div>

                <!-- Right Column: Controls -->
                <div class="right-column">
                    <!-- Controls Header -->
                    <div class="controls-header">
                        <div class="controls-title">3D Model Controls</div>
                        <div class="controls-subtitle">
                            Adjust geometry, materials, and environment
                        </div>
                    </div>

                    <!-- Tabs -->
                    <div class="controls-tabs">
                        <button
                            class="tab-button active"
                            data-tab="geometry"
                            id="geometry-tab"
                        >
                            Geometry
                        </button>
                        <button class="tab-button" data-tab="material">
                            Material
                        </button>
                        <button class="tab-button" data-tab="environment">
                            Environment
                        </button>
                        <button class="tab-button" data-tab="background">
                            Background
                        </button>
                    </div>

                    <!-- Tab Content -->
                    <div class="tab-content">
                        <!-- Geometry Panel -->
                        <div class="tab-panel active" id="geometry-panel">
                            <div class="control-group">
                                <label class="control-label">Depth</label>
                                <input
                                    type="range"
                                    class="control-slider"
                                    id="depthSlider"
                                    min="1"
                                    max="50"
                                    value="20"
                                />
                                <div class="slider-value" id="depthValue">
                                    20
                                </div>
                            </div>

                            <div class="control-group">
                                <label class="control-label">Bevel Size</label>
                                <input
                                    type="range"
                                    class="control-slider"
                                    id="bevelSizeSlider"
                                    min="0"
                                    max="5"
                                    step="0.1"
                                    value="0.5"
                                />
                                <div class="slider-value" id="bevelSizeValue">
                                    0.5
                                </div>
                            </div>

                            <div class="control-group">
                                <label class="control-label"
                                    >Bevel Thickness</label
                                >
                                <input
                                    type="range"
                                    class="control-slider"
                                    id="bevelThicknessSlider"
                                    min="0"
                                    max="3"
                                    step="0.1"
                                    value="1"
                                />
                                <div
                                    class="slider-value"
                                    id="bevelThicknessValue"
                                >
                                    1
                                </div>
                            </div>

                            <div class="control-group">
                                <label class="control-label"
                                    >Bevel Segments</label
                                >
                                <input
                                    type="range"
                                    class="control-slider"
                                    id="bevelSegmentsSlider"
                                    min="1"
                                    max="8"
                                    value="3"
                                />
                                <div
                                    class="slider-value"
                                    id="bevelSegmentsValue"
                                >
                                    3
                                </div>
                            </div>
                        </div>

                        <!-- Material Panel -->
                        <div class="tab-panel" id="material-panel">
                            <div class="control-group">
                                <label class="control-label">Color</label>
                                <input
                                    type="color"
                                    class="color-input"
                                    id="colorPicker"
                                    value="#808080"
                                />
                            </div>

                            <div class="control-group">
                                <label class="control-label">Roughness</label>
                                <input
                                    type="range"
                                    class="control-slider"
                                    id="roughnessSlider"
                                    min="0"
                                    max="1"
                                    step="0.01"
                                    value="0.7"
                                />
                                <div class="slider-value" id="roughnessValue">
                                    0.7
                                </div>
                            </div>

                            <div class="control-group">
                                <label class="control-label">Metalness</label>
                                <input
                                    type="range"
                                    class="control-slider"
                                    id="metalnessSlider"
                                    min="0"
                                    max="1"
                                    step="0.01"
                                    value="0.1"
                                />
                                <div class="slider-value" id="metalnessValue">
                                    0.1
                                </div>
                            </div>

                            <div class="control-group">
                                <label class="control-label">Clearcoat</label>
                                <input
                                    type="range"
                                    class="control-slider"
                                    id="clearcoatSlider"
                                    min="0"
                                    max="1"
                                    step="0.01"
                                    value="0"
                                />
                                <div class="slider-value" id="clearcoatValue">
                                    0
                                </div>
                            </div>

                            <div class="control-group">
                                <label class="control-label"
                                    >Transmission</label
                                >
                                <input
                                    type="range"
                                    class="control-slider"
                                    id="transmissionSlider"
                                    min="0"
                                    max="1"
                                    step="0.01"
                                    value="0"
                                />
                                <div
                                    class="slider-value"
                                    id="transmissionValue"
                                >
                                    0
                                </div>
                            </div>
                        </div>

                        <!-- Environment Panel -->
                        <div class="tab-panel" id="environment-panel">
                            <div class="control-group">
                                <label class="control-label"
                                    >Environment Intensity</label
                                >
                                <input
                                    type="range"
                                    class="control-slider"
                                    id="envIntensitySlider"
                                    min="0"
                                    max="2"
                                    step="0.1"
                                    value="1"
                                />
                                <div
                                    class="slider-value"
                                    id="envIntensityValue"
                                >
                                    1
                                </div>
                            </div>

                            <div class="control-group">
                                <label class="control-label"
                                    >Ambient Light</label
                                >
                                <input
                                    type="range"
                                    class="control-slider"
                                    id="ambientLightSlider"
                                    min="0"
                                    max="2"
                                    step="0.1"
                                    value="0.5"
                                />
                                <div
                                    class="slider-value"
                                    id="ambientLightValue"
                                >
                                    0.5
                                </div>
                            </div>

                            <div class="control-group">
                                <label class="control-label"
                                    >Directional Light</label
                                >
                                <input
                                    type="range"
                                    class="control-slider"
                                    id="directionalLightSlider"
                                    min="0"
                                    max="2"
                                    step="0.1"
                                    value="1"
                                />
                                <div
                                    class="slider-value"
                                    id="directionalLightValue"
                                >
                                    1
                                </div>
                            </div>
                        </div>

                        <!-- Background Panel -->
                        <div class="tab-panel" id="background-panel">
                            <div class="control-group">
                                <label class="control-label">
                                    <input
                                        type="checkbox"
                                        id="transparentBgCheckbox"
                                        checked
                                        style="margin-right: 8px"
                                    />
                                    Transparent Background
                                </label>
                            </div>
                            <div
                                class="control-group"
                                id="backgroundColorGroup"
                                style="display: none"
                            >
                                <label class="control-label"
                                    >Background Color</label
                                >
                                <input
                                    type="color"
                                    class="color-input"
                                    id="backgroundColorPicker"
                                    value="#f5f5f5"
                                />
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="action-buttons" id="actionButtons">
                        <div class="button-group">
                            <button class="button" id="loadNewButton">
                                Load New Model
                            </button>
                            <button class="button" id="resetButton">
                                Reset View
                            </button>
                            <button class="button primary" id="exportButton">
                                Export to SVG
                            </button>
                            <button class="button primary" id="exportPngButton">
                                Export to PNG
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Error Display -->
        <div class="error" id="error"></div>

        <!-- Progress Bar -->
        <div class="progress-bar-container" id="progressBarContainer">
            <div class="progress-bar" id="progressBar"></div>
            <div class="progress-text" id="progressText">Loading...</div>
        </div>
    </body>
</html>
